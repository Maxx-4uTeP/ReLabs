# CPH 12: Финальное задание Ceph
##### [Оглавление](../README.md)
### Описание:
Надо починить ceph-кластер, который поломался на предприятии, и тем самым восстановить работу рабочей базы. Ваш напарник не нашел ничего лучше, чем "застопорить кластер" для сохранения данных. К счастью вы недавно подготовили новый OSD-узел, но не вводили его в работу. Необходимо восстановить работоспособность кластера, а затем подготовить S3-бакет для работы с файлами.
##### Дано:
* 3 машины c поднятым кластером Ceph. На ceph3 поврежден диск.
* Заранее подготовленный OSD-узел ceph4.
* Машина клиента client.
### Задание:
1. В кластере Ceph на мастер-узле проверить флаг паузы и снять его.
2. Восстановить работу кластера:
    * Подготовить машину ceph4 к вводу в кластер;
    * Добавить на ceph4 ssh-ключ;
    * Добавить в кластер хост ceph4;
    * Добавить диск ceph4 в кластер;
    * Найти сбойный диск и удалить его из crushmap и с osd и соответствующий демон.
3. Проверить, что кластер заработал.
4. Поднять RGW realm=ceph.local rgw-zone=ceph.local все остальное defaults (radosgw-admin). Машины для размещения шлюзов: ceph1 и ceph2.
    * Создать realm;
    * Создать zonegroup;
    * Создать zone;
    * Произвести коммит изменений и соркестрировать контейнеры на ceph1 и ceph2.
    * Создать пользователя test (radosgw-admin).
5. На клиенте client установить необходимый софт awscli, boto, boto3 (pip install).
    * Сконфигурировать клиент client, используя полученные от кластера ключи - профиль ceph (aws configure);
    * Проверить настройки и доступ к гейтвею: если все работает, создать s3-бакет backup;
    * Создать файл test в s3-бакете backup.


